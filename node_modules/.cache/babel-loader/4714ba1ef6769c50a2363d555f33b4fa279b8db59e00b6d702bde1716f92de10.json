{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);const API_URL='http://localhost:5000/api';export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);// Check token and set user on initial load\nuseEffect(()=>{const token=localStorage.getItem('token');if(token){// Verify token with backend\nfetch(\"\".concat(API_URL,\"/auth/verify\"),{headers:{'Authorization':\"Bearer \".concat(token),'Accept':'application/json','Content-Type':'application/json'}}).then(res=>{if(!res.ok)throw new Error('Token verification failed');return res.json();}).then(data=>{if(data.user){setUser(data.user);}else{localStorage.removeItem('token');}}).catch(()=>{localStorage.removeItem('token');}).finally(()=>{setLoading(false);});}else{setLoading(false);}},[]);const signup=async userData=>{setLoading(true);setError(null);try{const response=await fetch(\"\".concat(API_URL,\"/auth/signup\"),{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify(userData)});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||'Signup failed');}const data=await response.json();return data;}catch(err){setError(err.message);throw err;}finally{setLoading(false);}};const signin=async credentials=>{setLoading(true);setError(null);try{console.log('Attempting signin with:',credentials);const response=await fetch(\"\".concat(API_URL,\"/auth/login\"),{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json'},body:JSON.stringify(credentials)});console.log('Response status:',response.status);if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||'Login failed');}const data=await response.json();console.log('Login response:',data);if(!data.token||!data.user){throw new Error('Invalid response format');}setUser(data.user);localStorage.setItem('token',data.token);return data;}catch(err){console.error('Signin error:',err);setError(err.message);throw err;}finally{setLoading(false);}};const signout=()=>{setUser(null);localStorage.removeItem('token');};const queryAI=async query=>{const token=localStorage.getItem('token');try{const response=await fetch(\"\".concat(API_URL,\"/query\"),{method:'POST',headers:{'Accept':'application/json','Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},body:JSON.stringify({query})});if(!response.ok){const errorData=await response.json();throw new Error(errorData.error||'Query failed');}const data=await response.json();return data;}catch(err){setError(err.message);throw err;}};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,loading,error,signup,signin,signout,queryAI},children:children});}export const useAuth=()=>useContext(AuthContext);","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","jsx","_jsx","AuthContext","API_URL","AuthProvider","_ref","children","user","setUser","loading","setLoading","error","setError","token","localStorage","getItem","fetch","concat","headers","then","res","ok","Error","json","data","removeItem","catch","finally","signup","userData","response","method","body","JSON","stringify","errorData","err","message","signin","credentials","console","log","status","setItem","signout","queryAI","query","Provider","value","useAuth"],"sources":["C:/Users/lucas/Desktop/CONCORDIA/QUARCC/LAB/QuarccAI/src/contexts/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\n\nconst AuthContext = createContext(null);\n\nconst API_URL = 'http://localhost:5000/api';\n\nexport function AuthProvider({ children }) {\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    // Check token and set user on initial load\n    useEffect(() => {\n        const token = localStorage.getItem('token');\n        if (token) {\n            // Verify token with backend\n            fetch(`${API_URL}/auth/verify`, {\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json'\n                }\n            })\n            .then(res => {\n                if (!res.ok) throw new Error('Token verification failed');\n                return res.json();\n            })\n            .then(data => {\n                if (data.user) {\n                    setUser(data.user);\n                } else {\n                    localStorage.removeItem('token');\n                }\n            })\n            .catch(() => {\n                localStorage.removeItem('token');\n            })\n            .finally(() => {\n                setLoading(false);\n            });\n        } else {\n            setLoading(false);\n        }\n    }, []);\n\n    const signup = async (userData) => {\n        setLoading(true);\n        setError(null);\n        try {\n            const response = await fetch(`${API_URL}/auth/signup`, {\n                method: 'POST',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(userData),\n            });\n            \n            if (!response.ok) {\n                const errorData = await response.json();\n                throw new Error(errorData.error || 'Signup failed');\n            }\n            \n            const data = await response.json();\n            return data;\n        } catch (err) {\n            setError(err.message);\n            throw err;\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const signin = async (credentials) => {\n        setLoading(true);\n        setError(null);\n        try {\n            console.log('Attempting signin with:', credentials);\n            const response = await fetch(`${API_URL}/auth/login`, {\n                method: 'POST',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(credentials),\n            });\n            \n            console.log('Response status:', response.status);\n            \n            if (!response.ok) {\n                const errorData = await response.json();\n                throw new Error(errorData.error || 'Login failed');\n            }\n            \n            const data = await response.json();\n            console.log('Login response:', data);\n            \n            if (!data.token || !data.user) {\n                throw new Error('Invalid response format');\n            }\n            \n            setUser(data.user);\n            localStorage.setItem('token', data.token);\n            return data;\n        } catch (err) {\n            console.error('Signin error:', err);\n            setError(err.message);\n            throw err;\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const signout = () => {\n        setUser(null);\n        localStorage.removeItem('token');\n    };\n\n    const queryAI = async (query) => {\n        const token = localStorage.getItem('token');\n        try {\n            const response = await fetch(`${API_URL}/query`, {\n                method: 'POST',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${token}`\n                },\n                body: JSON.stringify({ query })\n            });\n            \n            if (!response.ok) {\n                const errorData = await response.json();\n                throw new Error(errorData.error || 'Query failed');\n            }\n            \n            const data = await response.json();\n            return data;\n        } catch (err) {\n            setError(err.message);\n            throw err;\n        }\n    };\n\n    return (\n        <AuthContext.Provider value={{ \n            user, \n            loading, \n            error, \n            signup, \n            signin, \n            signout,\n            queryAI \n        }}>\n            {children}\n        </AuthContext.Provider>\n    );\n}\n\nexport const useAuth = () => useContext(AuthContext);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}